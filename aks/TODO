Work in progress
Refactore the code for prod ready deploy